angular.module("angularValidator",[]),angular.module("angularValidator").directive("angularValidator",["$injector",function(a){return{restrict:"A",link:function(b,c,d,e){function f(b){return b&&"invalid-message"in b.attributes?a.get(b.attributes["invalid-message"].value):!1}function g(a){for(var b=f(a),c=0;c<a.length;c++)c in a&&h(a[c],b)}function h(a,c){"validate-on"in a.attributes&&"blur"===a.attributes["validate-on"].value&&angular.element(a).on("blur",function(){l(a,c),o(a)});var d=b.$watch(function(){return a.value+a.required+s.submitted+k(a)+i(s[a.name])+j(s[a.name])},function(){if(s.submitted)l(a,c),o(a);else{var b="validate-on"in a.attributes&&"dirty"===a.attributes["validate-on"].value;b?(l(a,c),o(a)):s[a.name]&&s[a.name].$pristine&&(l(a,c),o(a))}});q.push(d)}function i(a){return a&&"$dirty"in a?a.$dirty:void 0}function j(a){return a&&"$valid"in a?a.$valid:void 0}function k(a){if("validator"in a.attributes){var c=b.$eval(a.attributes.validator.value);return s[a.name].$setValidity("angularValidator",c),c}}function l(a,c){var d=function(){return"<i class='fa fa-times'></i> Required"},e=function(){return"<i class='fa fa-times'></i> Invalid"};if(a.name in s){var f=s[a.name],g=n(a);g&&g.remove(),(f.$dirty||b[a.form.name]&&b[a.form.name].submitted)&&(f.$error.required?"required-message"in a.attributes?angular.element(a).after(m(a.attributes["required-message"].value)):angular.element(a).after(m(d)):f.$valid||("invalid-message"in a.attributes?angular.element(a).after(m(a.attributes["invalid-message"].value)):c?angular.element(a).after(m(c.message(f,a))):angular.element(a).after(m(e))))}}function m(a){return"<label class='control-label has-error validationMessage'>"+b.$eval(a)+"</label>"}function n(a){for(var b=angular.element(a).parent().children(),c=0;c<b.length;c++)if(angular.element(b[c]).hasClass("validationMessage"))return angular.element(b[c]);return!1}function o(a){if(a.name in s){var c=s[a.name];angular.element(a).removeClass("has-error"),angular.element(a.parentNode).removeClass("has-error"),(c.$dirty||b[a.form.name]&&b[a.form.name].submitted)&&c.$invalid&&(angular.element(a.parentNode).addClass("has-error"),angular.element(a).addClass("has-error"))}}var p=angular.element(c)[0],q=[],r=p.attributes.name.value,s=b[r];s.submitted=!1,b.$watch(function(){return Object.keys(s).length},function(){angular.forEach(q,function(a){a()}),g(p)}),c.on("submit",function(a){a.preventDefault(),b.$apply(function(){s.submitted=!0}),s.$valid&&b.$apply(function(){b.$eval(p.attributes["angular-validator-submit"].value)})}),s.reset=function(){for(var a=0;a<p.length;a++)p[a].name&&(s[p[a].name].$setViewValue(""),s[p[a].name].$render());s.submitted=!1,s.$setPristine()},g(p)}}}]);